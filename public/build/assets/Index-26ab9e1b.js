import{_ as p,a as h,o as a,c as i,b as e,h as b,F as v,g as F,w as E,i as c,v as m,n as u,t as l,j as f,e as y}from"./app-1cdcaa82.js";import R from"./Master-7e8cd8ef.js";import"http://ttcglobal.test/backend/assets/vendor/bootstrap/js/bootstrap.bundle.min.js";const g={layout:R,props:["country"],data(){return{referrals:[],referralForm:{name:"",email:"",phone:"",address:"",id:"",commission:""},referralErrors:{},referralStatus:1}},created(){this.fetchReferrals()},methods:{openModal(t=null){t?this.referralForm={...t}:this.clearFields();const o=document.getElementById("referralModal");new bootstrap.Modal(o).show()},clearFields(){this.referralForm={name:"",email:"",phone:"",address:"",id:null,commission:""},this.referralErrors={}},editReferral(t){this.openModal(t)},fetchReferrals(){h.get(route("api.referrals.fetch"),{headers:{Authorization:"Bearer "+this.$page.props.auth_token}}).then(t=>{this.referrals=t.data}).catch(t=>{console.error(t)})},validateReferralForm(){this.referralErrors={},this.referralForm.name||(this.referralErrors.name="Name is required."),this.referralForm.email||(this.referralErrors.email="Email is required."),this.referralForm.phone||(this.referralErrors.phone="Phone Number is required."),this.referralForm.commission||(this.referralErrors.commission="Commission is required.")},submitReferral(){if(this.validateReferralForm(),Object.keys(this.referralErrors).length>0)return;this.referralStatus=0;const t=(this.referralForm.id,route("api.referrals.store"));h({method:"post",url:t,data:this.referralForm,headers:{Authorization:"Bearer "+this.$page.props.auth_token}}).then(()=>{toastr.success("Referral saved successfully."),this.fetchReferrals(),this.referralStatus=1,this.clearFields(),document.getElementById("referralModal").click()}).catch(n=>{this.referralStatus=1,toastr.error(n.response.data.message),n.response.data.errors&&(this.referralErrors=n.response.data.errors)})},deleteReferral(t){h.delete(route("api.referrals.delete",t)).then(()=>{toastr.success("Referral deleted successfully."),this.fetchReferrals()}).catch(o=>{console.error(o)})}}},k={id:"main",class:"main"},x={class:"pagetitle d-flex justify-content-between"},N=y('<div><h1 class="theme-text-color">Referrals</h1><nav><ol class="breadcrumb"><li class="breadcrumb-item"><a href="dashboard">TTC Global</a></li><li class="breadcrumb-item active">Referrals</li></ol></nav></div>',1),S=e("i",{class:"bi bi-plus-lg"},null,-1),w={class:"section"},C={class:"card"},M={class:"card-body"},V=e("h5",{class:"card-title theme-text-color"}," Referral Records ",-1),A={class:"table table-striped"},B=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Name"),e("th",{scope:"col"},"Email"),e("th",{scope:"col"},"Commission"),e("th",{scope:"col"},"Phone"),e("th",{scope:"col"},"Address"),e("th",{scope:"col"},"Actions")])],-1),I={scope:"row"},U=["href"],q=["onClick"],T=e("i",{class:"bi bi-pencil"},null,-1),j=[T],z={class:"modal fade",id:"referralModal",tabindex:"-1","aria-hidden":"true"},P={class:"modal-dialog"},D={class:"modal-content"},O=e("div",{class:"modal-header"},[e("h5",{class:"modal-title"},"Referral Registration"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),G={class:"modal-body"},L={class:"row g-3"},H={class:"col-12"},J=e("label",{for:"name",class:"form-label"},"Name",-1),K={key:0,class:"invalid-feedback"},Q={class:"col-12"},W=e("label",{class:"form-label"},"Commission",-1),X={key:0,class:"invalid-feedback"},Y={class:"col-12"},Z=e("label",{for:"phone",class:"form-label"},"Phone",-1),$={key:0,class:"invalid-feedback"},ee={class:"col-12"},re=e("label",{for:"email",class:"form-label"},"Email ",-1),se={key:0,class:"invalid-feedback"},oe={class:"col-12"},te=e("label",{for:"address",class:"form-label"},"Address (Optional)",-1),le=["disabled"];function ae(t,o,n,ie,r,d){return a(),i("main",k,[e("div",x,[N,e("div",null,[e("button",{class:"btn btn-success mt-3","data-bs-toggle":"modal","data-bs-target":"#referralModal",onClick:o[0]||(o[0]=(...s)=>d.clearFields&&d.clearFields(...s))},[S,b(" Add New Referral ")])])]),e("section",w,[e("div",C,[e("div",M,[V,e("table",A,[B,e("tbody",null,[(a(!0),i(v,null,F(r.referrals,(s,_)=>(a(),i("tr",{key:s.id},[e("th",I,l(_+1),1),e("td",null,[e("a",{class:"theme-text-color",href:t.route("referral.details",s.id)},l(s.name),9,U)]),e("td",null,l(s.email),1),e("td",null,l(s.commission)+"%",1),e("td",null,l(s.phone||"N/A"),1),e("td",null,l(s.address||"N/A"),1),e("td",null,[e("button",{class:"btn btn-sm btn-warning",onClick:ne=>d.editReferral(s)},j,8,q)])]))),128))])])])]),e("div",z,[e("div",P,[e("div",D,[O,e("div",G,[e("form",{onSubmit:o[6]||(o[6]=E((...s)=>d.submitReferral&&d.submitReferral(...s),["prevent"]))},[e("div",L,[e("div",H,[J,c(e("input",{type:"text",class:u(["form-control",{"is-invalid":r.referralErrors.name}]),"onUpdate:modelValue":o[1]||(o[1]=s=>r.referralForm.name=s)},null,2),[[m,r.referralForm.name]]),r.referralErrors.name?(a(),i("div",K,l(r.referralErrors.name),1)):f("",!0)]),e("div",Q,[W,c(e("input",{type:"text",class:u(["form-control",{"is-invalid":r.referralErrors.commission}]),"onUpdate:modelValue":o[2]||(o[2]=s=>r.referralForm.commission=s)},null,2),[[m,r.referralForm.commission]]),r.referralErrors.commission?(a(),i("div",X,l(r.referralErrors.commission),1)):f("",!0)]),e("div",Y,[Z,c(e("input",{type:"text",class:u(["form-control",{"is-invalid":r.referralErrors.phone}]),"onUpdate:modelValue":o[3]||(o[3]=s=>r.referralForm.phone=s)},null,2),[[m,r.referralForm.phone]]),r.referralErrors.phone?(a(),i("div",$,l(r.referralErrors.phone),1)):f("",!0)]),e("div",ee,[re,c(e("input",{type:"email",class:"form-control","onUpdate:modelValue":o[4]||(o[4]=s=>r.referralForm.email=s)},null,512),[[m,r.referralForm.email]]),r.referralErrors.email?(a(),i("div",se,l(r.referralErrors.email),1)):f("",!0)]),e("div",oe,[te,c(e("input",{type:"text",class:"form-control","onUpdate:modelValue":o[5]||(o[5]=s=>r.referralForm.address=s)},null,512),[[m,r.referralForm.address]])])]),e("button",{type:"submit",class:"btn btn-success mt-3",disabled:r.referralStatus===0},l(r.referralStatus===1?"Save Referral":"Saving..."),9,le)],32)])])])])])])}const fe=p(g,[["render",ae]]);export{fe as default};

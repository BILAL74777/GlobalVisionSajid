import{_ as p,a as h,o as a,c as i,b as e,h as b,F as v,g as F,w as E,i as c,v as m,n as u,t as l,j as f,e as y}from"./app-6bf8987b.js";import R from"./Master-89212e55.js";const g={layout:R,props:["country"],data(){return{referrals:[],referralForm:{name:"",email:"",phone:"",address:"",id:"",commission:""},referralErrors:{},referralStatus:1}},created(){this.fetchReferrals()},methods:{openModal(t=null){t?this.referralForm={...t}:this.clearFields();const o=document.getElementById("referralModal");new bootstrap.Modal(o).show()},clearFields(){this.referralForm={name:"",email:"",phone:"",address:"",id:null,commission:""},this.referralErrors={}},editReferral(t){this.openModal(t)},fetchReferrals(){h.get(route("api.referrals.fetch"),{headers:{Authorization:"Bearer "+this.$page.props.auth_token}}).then(t=>{this.referrals=t.data}).catch(t=>{console.error(t)})},validateReferralForm(){this.referralErrors={},this.referralForm.name||(this.referralErrors.name="Name is required."),this.referralForm.email||(this.referralErrors.email="Email is required."),this.referralForm.phone||(this.referralErrors.phone="Phone Number is required."),this.referralForm.commission||(this.referralErrors.commission="Commission is required.")},submitReferral(){if(this.validateReferralForm(),Object.keys(this.referralErrors).length>0)return;this.referralStatus=0;const t=(this.referralForm.id,route("api.referrals.store"));h({method:"post",url:t,data:this.referralForm,headers:{Authorization:"Bearer "+this.$page.props.auth_token}}).then(()=>{toastr.success("Referral saved successfully."),this.fetchReferrals(),this.referralStatus=1,this.clearFields(),this.$refs.closeModal.click()}).catch(n=>{this.referralStatus=1,toastr.error(n.response.data.message),n.response.data.errors&&(this.referralErrors=n.response.data.errors)})},deleteReferral(t){h.delete(route("api.referrals.delete",t)).then(()=>{toastr.success("Referral deleted successfully."),this.fetchReferrals()}).catch(o=>{console.error(o)})}}},k={id:"main",class:"main"},x={class:"pagetitle d-flex justify-content-between"},M=y('<div><h1 class="theme-text-color">Referrals</h1><nav><ol class="breadcrumb"><li class="breadcrumb-item"><a href="dashboard">TTC Global</a></li><li class="breadcrumb-item active">Referrals</li></ol></nav></div>',1),N=e("i",{class:"bi bi-plus-lg"},null,-1),S={class:"section"},w={class:"card"},C={class:"card-body"},V=e("h5",{class:"card-title theme-text-color"}," Referral Records ",-1),A={class:"table table-striped"},B=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Name"),e("th",{scope:"col"},"Email"),e("th",{scope:"col"},"Commission"),e("th",{scope:"col"},"Phone"),e("th",{scope:"col"},"Address"),e("th",{scope:"col"},"Actions")])],-1),I={scope:"row"},U=["href"],q=["onClick"],T=e("i",{class:"bi bi-pencil"},null,-1),j=[T],z={class:"modal fade",id:"referralModal",tabindex:"-1","aria-hidden":"true"},P={class:"modal-dialog"},D={class:"modal-content"},O={class:"modal-header"},G=e("h5",{class:"modal-title"},"Referral Registration",-1),L={type:"button",ref:"closeModal",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},H={class:"modal-body"},J={class:"row g-3"},K={class:"col-12"},Q=e("label",{for:"name",class:"form-label"},"Name",-1),W={key:0,class:"invalid-feedback"},X={class:"col-12"},Y=e("label",{class:"form-label"},"Commission",-1),Z={key:0,class:"invalid-feedback"},$={class:"col-12"},ee=e("label",{for:"phone",class:"form-label"},"Phone",-1),re={key:0,class:"invalid-feedback"},se={class:"col-12"},oe=e("label",{for:"email",class:"form-label"},"Email ",-1),te={key:0,class:"invalid-feedback"},le={class:"col-12"},ae=e("label",{for:"address",class:"form-label"},"Address (Optional)",-1),ie=["disabled"];function ne(t,o,n,de,r,d){return a(),i("main",k,[e("div",x,[M,e("div",null,[e("button",{class:"btn btn-success mt-3","data-bs-toggle":"modal","data-bs-target":"#referralModal",onClick:o[0]||(o[0]=(...s)=>d.clearFields&&d.clearFields(...s))},[N,b(" Add New Referral ")])])]),e("section",S,[e("div",w,[e("div",C,[V,e("table",A,[B,e("tbody",null,[(a(!0),i(v,null,F(r.referrals,(s,_)=>(a(),i("tr",{key:s.id},[e("th",I,l(_+1),1),e("td",null,[e("a",{class:"theme-text-color",href:t.route("referral.details",s.id)},l(s.name),9,U)]),e("td",null,l(s.email),1),e("td",null,l(s.commission)+"%",1),e("td",null,l(s.phone||"N/A"),1),e("td",null,l(s.address||"N/A"),1),e("td",null,[e("button",{class:"btn btn-sm btn-warning",onClick:ce=>d.editReferral(s)},j,8,q)])]))),128))])])])]),e("div",z,[e("div",P,[e("div",D,[e("div",O,[G,e("button",L,null,512)]),e("div",H,[e("form",{onSubmit:o[6]||(o[6]=E((...s)=>d.submitReferral&&d.submitReferral(...s),["prevent"]))},[e("div",J,[e("div",K,[Q,c(e("input",{type:"text",class:u(["form-control",{"is-invalid":r.referralErrors.name}]),"onUpdate:modelValue":o[1]||(o[1]=s=>r.referralForm.name=s)},null,2),[[m,r.referralForm.name]]),r.referralErrors.name?(a(),i("div",W,l(r.referralErrors.name),1)):f("",!0)]),e("div",X,[Y,c(e("input",{type:"text",class:u(["form-control",{"is-invalid":r.referralErrors.commission}]),"onUpdate:modelValue":o[2]||(o[2]=s=>r.referralForm.commission=s)},null,2),[[m,r.referralForm.commission]]),r.referralErrors.commission?(a(),i("div",Z,l(r.referralErrors.commission),1)):f("",!0)]),e("div",$,[ee,c(e("input",{type:"text",class:u(["form-control",{"is-invalid":r.referralErrors.phone}]),"onUpdate:modelValue":o[3]||(o[3]=s=>r.referralForm.phone=s)},null,2),[[m,r.referralForm.phone]]),r.referralErrors.phone?(a(),i("div",re,l(r.referralErrors.phone),1)):f("",!0)]),e("div",se,[oe,c(e("input",{type:"email",class:"form-control","onUpdate:modelValue":o[4]||(o[4]=s=>r.referralForm.email=s)},null,512),[[m,r.referralForm.email]]),r.referralErrors.email?(a(),i("div",te,l(r.referralErrors.email),1)):f("",!0)]),e("div",le,[ae,c(e("input",{type:"text",class:"form-control","onUpdate:modelValue":o[5]||(o[5]=s=>r.referralForm.address=s)},null,512),[[m,r.referralForm.address]])])]),e("button",{type:"submit",class:"btn btn-success mt-3",disabled:r.referralStatus===0},l(r.referralStatus===1?"Save Referral":"Saving..."),9,ie)],32)])])])])])])}const he=p(g,[["render",ne]]);export{he as default};

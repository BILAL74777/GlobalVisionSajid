import k from"./Master-3764f6a3.js";import{s as y}from"./multiselect-35dda176.js";import{Z as w}from"./main-e5c00285.js";import{_ as E,a as h,r as V,o as d,c as n,b as s,t,h as c,F as x,g as T,i as m,v as _,n as r,j as u,d as b}from"./app-ec0684be.js";const R={layout:k,components:{Multiselect:y,Datepicker:w},props:["country"],created(){this.fetchRecords(),this.referralsPluck(),this.employeesPluck()},data(){return{today:this.getPakistanDate(),dataTable:null,selectedVisa:null,selectedVisa:{},pluckedReferrals:[],pluckedEmployees:[],tab:"single",individualForm:{id:"",full_name:"",phone_number:"",status:"",amount:"",tracking_id:"",visa_fee:"",gmail:"",pak_visa_password:"",gmail_password:"",gender:"",date:"",family_members:1,referral:"",referral_commission:"",employee:[]},individualFormErrors:{},formErrors:{},individualFormStatus:1,statusOptions:["Initial","Applied","Refunded","Rejected","Approved"],genderOptions:["Male","Female","Other"],VisasRecords:[],filters:{full_name:"",tracking_id:"",gmail:"",phone_number:""}}},mounted(){this.$nextTick(()=>{this.initializeDataTable()})},methods:{getPakistanDate(){let l=new Intl.DateTimeFormat("en-CA",{timeZone:"Asia/Karachi",year:"numeric",month:"2-digit",day:"2-digit"}).formatToParts(new Date),v=l.find(a=>a.type==="year").value,f=l.find(a=>a.type==="month").value,e=l.find(a=>a.type==="day").value;return`${v}-${f}-${e}`},submitIndividualForm(){this.validateIndividualForm(),!(Object.keys(this.individualFormErrors).length>0)&&(this.individualForm.referral==null||this.individualForm.referral==""||this.individualForm.referral==null?this.individualForm.referral="":this.individualForm.referral=this.individualForm.referral,this.individualFormStatus=0,h.post(route("api.individual.customer.store"),this.individualForm,{headers:{Authorization:"Bearer "+this.$page.props.auth_token}}).then(()=>{toastr.success("Record saved successfully."),this.$refs.closeThisModal.click(),this.fetchRecords(),this.individualFormStatus=1}).catch(o=>{this.individualFormStatus=1,toastr.error(o.response.data.message),this.individualFormErrors.tracking_id="The tracking id has already been taken.",o.response.data.errors&&(this.formErrors=o.response.data.errors)}))},fetchRecords(){h.get(route("api.individual.customer.fetch"),{headers:{Authorization:"Bearer "+this.$page.props.auth_token}}).then(o=>{this.VisasRecords=o.data,this.dataTable&&(this.dataTable.destroy(),this.dataTable=null),this.$nextTick(()=>{this.initializeDataTable()})}).catch(o=>{toastr.error(o.response.data.message)})},initializeDataTable(){this.$nextTick(()=>{this.dataTable=$("#ledgerTable").DataTable({responsive:!0,autoWidth:!1,paging:!0,searching:!0,ordering:!0,lengthMenu:[15,30,100],language:{search:"Search:",lengthMenu:"Show _MENU_ entries",info:"Showing _START_ to _END_ of _TOTAL_ entries",paginate:{first:"First",last:"Last",next:"Next",previous:"Previous"}}})})},getRowClass(o){switch(o){case"Applied":return"bg-light-gray";case"Refunded":return"bg-orange";case"Rejected":return"bg-red";case"Approved":return"bg-green";default:return""}},openModal(o){this.selectedVisa=o,new bootstrap.Modal(document.getElementById("visaModal")).show()},editRecord(o){this.clearFields(),this.individualForm={...o}},clearFields(){this.individualForm={id:"",full_name:"",phone_number:"",status:"",amount:"",tracking_id:"",visa_fee:"",gmail:"",pak_visa_password:"",gmail_password:"",gender:"",date:"",family_members:1,referral:"",referral_commission:"",employee:[]},this.individualFormErrors={}},deleteThis(o){h.delete(route("api.customer.visa.record.delete",o)).then(()=>{this.fetchRecords(),toastr.success("Transaction entry deleted successfully.")}).catch(l=>{console.error(l)})},validateIndividualForm(){this.individualFormErrors={},["full_name","phone_number","status","amount","visa_fee","tracking_id","gmail","pak_visa_password","gmail_password","gender","date"].forEach(l=>{this.individualForm[l]||(this.individualFormErrors[l]=`${l.replace(/_/g," ")} is required`)}),this.individualForm.amount&&this.individualForm.visa_fee&&parseFloat(this.individualForm.amount)<=parseFloat(this.individualForm.visa_fee)&&(this.individualFormErrors.amount="Amount must be greater than Visa Fee")},referralsPluck(){h.get(route("api.referrals.pluck"),{headers:{Authorization:"Bearer "+this.$page.props.auth_token}}).then(o=>{this.pluckedReferrals=o.data}).catch(o=>{toastr.error(o.response.data.message)})},employeesPluck(){h.get(route("api.employees.pluck"),{headers:{Authorization:"Bearer "+this.$page.props.auth_token}}).then(o=>{this.pluckedEmployees=o.data}).catch(o=>{toastr.error(o.response.data.message)})}}},C={id:"main",class:"main"},A={class:"pagetitle d-flex justify-content-between"},D={class:"theme-text-color"},M={class:"breadcrumb"},P=s("li",{class:"breadcrumb-item"},[s("a",{href:"dashboard"},"Global Vision")],-1),I={class:"breadcrumb-item"},S=s("li",{class:"breadcrumb-item active"},"Individual Visas",-1),U=s("i",{class:"bi bi-plus-lg"},null,-1),N={class:"section"},B={class:"card"},z={class:"card-body"},O=s("h5",{class:"card-title theme-text-color"}," Individual Records ",-1),G={class:"table-responsive"},j={id:"ledgerTable",class:"table"},L=s("thead",null,[s("tr",null,[s("th",null,"#"),s("th",null,"Name"),s("th",null,"Phone #"),s("th",null,"Status"),s("th",null,"Amount"),s("th",null,"Tracking ID"),s("th",null,"Actions")])],-1),Z={class:"text-white"},q=["onClick"],K=["onClick"],W=s("i",{class:"bi bi-pencil"},null,-1),H=[W],J={class:"modal fade",id:"visaModal",tabindex:"-1","aria-labelledby":"modalTitle","aria-hidden":"true","data-bs-backdrop":"static","data-bs-keyboard":"false"},Q={class:"modal-dialog"},X={class:"modal-content"},Y={class:"modal-header"},ss={class:"modal-title",id:"modalTitle"},es=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),is={class:"modal-body"},ls={class:"table-responsive"},ts={class:"table table-striped"},os=s("th",{scope:"row"},"Phone Number",-1),as=s("th",{scope:"row"},"Status",-1),rs=s("th",{scope:"row"},"Amount",-1),ds=s("th",{scope:"row"},"Visa Fee",-1),ns=s("th",{scope:"row"},"Tracking ID",-1),us=s("th",{scope:"row"},"Email",-1),cs=s("th",{scope:"row"},"Gender",-1),ms=s("th",{scope:"row"},"Date",-1),_s=s("th",{scope:"row"}," Pak Visa Password ",-1),hs=s("th",{scope:"row"},"Gmail Password",-1),vs=s("th",{scope:"row"},"Applied By",-1),ps={class:"modal fade",id:"visarecordmodal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true","data-bs-backdrop":"static","data-bs-keyboard":"false"},bs={class:"modal-dialog modal-lg"},fs={class:"modal-content"},gs={class:"modal-header"},Fs=s("div",{class:"section-title"},[s("h5",{class:"c-theme-red"}," Individual Apply Form ")],-1),ks={ref:"closeThisModal",type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},ys={class:"modal-body"},ws={class:"tab-content"},Es={class:"row g-3"},Vs={class:"col-12 col-md-6"},xs=s("label",{class:"form-label"},[c(t("Date")),s("i",{class:"text-danger"},"*")],-1),Ts=["max"],Rs={key:0,class:"invalid-feedback"},Cs={class:"col-md-6 col-12"},As=s("label",{for:"individual_full_name",class:"form-label"},[c("Full Name"),s("i",{class:"text-danger"},"*")],-1),Ds={key:0,class:"invalid-feedback"},Ms={class:"col-md-6 col-12"},Ps=s("label",{for:"individual_phone_number",class:"form-label"},[c("Phone Number"),s("i",{class:"text-danger"},"*")],-1),Is={key:0,class:"invalid-feedback"},Ss={class:"col-md-6 col-12"},Us=s("label",{for:"individual_status",class:"form-label"},[c("Status"),s("i",{class:"text-danger"},"*")],-1),Ns={key:0,class:"invalid-feedback"},Bs={class:"col-md-6 col-12"},zs=s("label",{for:"individual_tracking_id",class:"form-label"},[c("Tracking ID"),s("i",{class:"text-danger"},"*")],-1),Os={key:0,class:"invalid-feedback"},Gs={class:"col-md-6 col-12"},js=s("label",{for:"individual_amount",class:"form-label"},[c("Amount"),s("i",{class:"text-danger"},"*")],-1),Ls={key:0,class:"invalid-feedback"},Zs={class:"col-md-6 col-12"},qs=s("label",{for:"visa_fee",class:"form-label"},[c("Visa Fee"),s("i",{class:"text-danger"},"*")],-1),Ks={key:0,class:"invalid-feedback"},Ws={class:"col-md-6 col-12"},Hs=s("label",{for:"individual_gmail",class:"form-label"},[c("Gmail"),s("i",{class:"text-danger"},"*")],-1),Js={key:0,class:"invalid-feedback"},Qs={class:"col-md-6 col-12"},Xs=s("label",{for:"individual_pak_visa_password",class:"form-label"},[c("Pak Visa Password"),s("i",{class:"text-danger"},"*")],-1),Ys={key:0,class:"invalid-feedback"},$s={class:"col-md-6 col-12"},se=s("label",{for:"individual_gmail_password",class:"form-label"},[c("Gmail Password"),s("i",{class:"text-danger"},"*")],-1),ee={key:0,class:"invalid-feedback"},ie={class:"col-md-6 col-12"},le=s("label",{for:"individual_gender",class:"form-label"},[c("Gender"),s("i",{class:"text-danger"},"*")],-1),te={key:0,class:"invalid-feedback"},oe={class:"col-md-6 col-12"},ae=s("label",{for:"referral",class:"form-label"},"Referrals ",-1),re={key:0,class:"invalid-feedback"},de=["disabled"];function ne(o,l,v,f,e,a){const p=V("Multiselect");return d(),n("main",C,[s("div",A,[s("div",null,[s("h1",D,t(v.country),1),s("nav",null,[s("ol",M,[P,s("li",I,t(v.country),1),S])])]),s("div",null,[s("button",{class:"btn btn-success mt-3","data-bs-toggle":"modal","data-bs-target":"#visarecordmodal",onClick:l[0]||(l[0]=(...i)=>a.clearFields&&a.clearFields(...i))},[U,c(" Add New Record ")])])]),s("section",N,[s("div",B,[s("div",z,[O,s("div",G,[s("table",j,[L,s("tbody",Z,[(d(!0),n(x,null,T(e.VisasRecords,(i,g)=>(d(),n("tr",{key:i.id},[s("td",{class:r(a.getRowClass(i.status))},t(g+1),3),s("td",{class:r(a.getRowClass(i.status))},[s("a",{href:"#",class:r(["theme-text-color",a.getRowClass(i.status)]),onClick:F=>a.openModal(i)},t(i.full_name),11,q)],2),s("td",{class:r(a.getRowClass(i.status))},t(i.phone_number),3),s("td",{class:r(a.getRowClass(i.status))},t(i.status),3),s("td",{class:r(a.getRowClass(i.status))},t(i.amount),3),s("td",{class:r(a.getRowClass(i.status))},t(i.tracking_id),3),s("td",{class:r(a.getRowClass(i.status))},[s("button",{class:"btn btn-sm btn-warning","data-bs-toggle":"modal","data-bs-target":"#visarecordmodal",onClick:F=>a.editRecord(i)},H,8,K)],2)]))),128))])])])])]),s("div",J,[s("div",Q,[s("div",X,[s("div",Y,[s("h5",ss,t(e.selectedVisa.full_name),1),es]),s("div",is,[s("div",ls,[s("table",ts,[s("tbody",null,[s("tr",null,[os,s("td",null,t(e.selectedVisa.phone_number),1)]),s("tr",null,[as,s("td",null,t(e.selectedVisa.status),1)]),s("tr",null,[rs,s("td",null,t(e.selectedVisa.amount),1)]),s("tr",null,[ds,s("td",null,t(e.selectedVisa.visa_fee),1)]),s("tr",null,[ns,s("td",null,t(e.selectedVisa.tracking_id),1)]),s("tr",null,[us,s("td",null,t(e.selectedVisa.gmail),1)]),s("tr",null,[cs,s("td",null,t(e.selectedVisa.gender),1)]),s("tr",null,[ms,s("td",null,t(e.selectedVisa.date),1)]),s("tr",null,[_s,s("td",null,t(e.selectedVisa.pak_visa_password),1)]),s("tr",null,[hs,s("td",null,t(e.selectedVisa.gmail_password),1)]),s("tr",null,[vs,s("td",null,t(e.selectedVisa.added_by_user),1)])])])])])])])]),s("div",ps,[s("div",bs,[s("div",fs,[s("div",gs,[Fs,s("button",ks,null,512)]),s("div",ys,[s("div",ws,[s("div",null,[s("div",Es,[s("div",Vs,[xs,m(s("input",{type:"date",class:r(["form-control",{"is-invalid":e.individualFormErrors.date}]),"onUpdate:modelValue":l[1]||(l[1]=i=>e.individualForm.date=i),max:e.today,id:"date"},null,10,Ts),[[_,e.individualForm.date]]),e.individualFormErrors.date?(d(),n("div",Rs,t(e.individualFormErrors.date),1)):u("",!0)]),s("div",Cs,[As,m(s("input",{type:"text",class:r(["form-control",{"is-invalid":e.individualFormErrors.full_name}]),"onUpdate:modelValue":l[2]||(l[2]=i=>e.individualForm.full_name=i)},null,2),[[_,e.individualForm.full_name]]),e.individualFormErrors.full_name?(d(),n("div",Ds,t(e.individualFormErrors.full_name),1)):u("",!0)]),s("div",Ms,[Ps,m(s("input",{type:"text",class:r(["form-control",{"is-invalid":e.individualFormErrors.phone_number}]),"onUpdate:modelValue":l[3]||(l[3]=i=>e.individualForm.phone_number=i)},null,2),[[_,e.individualForm.phone_number]]),e.individualFormErrors.phone_number?(d(),n("div",Is,t(e.individualFormErrors.phone_number),1)):u("",!0)]),s("div",Ss,[Us,b(p,{modelValue:e.individualForm.status,"onUpdate:modelValue":l[4]||(l[4]=i=>e.individualForm.status=i),options:e.statusOptions,searchable:!0,class:r({"is-invalid":e.individualFormErrors.status})},null,8,["modelValue","options","class"]),e.individualFormErrors.status?(d(),n("div",Ns,t(e.individualFormErrors.status),1)):u("",!0)]),s("div",Bs,[zs,m(s("input",{type:"text",class:r(["form-control",{"is-invalid":e.individualFormErrors.tracking_id}]),"onUpdate:modelValue":l[5]||(l[5]=i=>e.individualForm.tracking_id=i)},null,2),[[_,e.individualForm.tracking_id]]),e.individualFormErrors.tracking_id?(d(),n("div",Os,t(e.individualFormErrors.tracking_id),1)):u("",!0)]),s("div",Gs,[js,m(s("input",{type:"number",class:r(["form-control",{"is-invalid":e.individualFormErrors.amount}]),"onUpdate:modelValue":l[6]||(l[6]=i=>e.individualForm.amount=i)},null,2),[[_,e.individualForm.amount]]),e.individualFormErrors.amount?(d(),n("div",Ls,t(e.individualFormErrors.amount),1)):u("",!0)]),s("div",Zs,[qs,m(s("input",{type:"number",class:r(["form-control",{"is-invalid":e.individualFormErrors.visa_fee}]),"onUpdate:modelValue":l[7]||(l[7]=i=>e.individualForm.visa_fee=i)},null,2),[[_,e.individualForm.visa_fee]]),e.individualFormErrors.visa_fee?(d(),n("div",Ks,t(e.individualFormErrors.visa_fee),1)):u("",!0)]),s("div",Ws,[Hs,m(s("input",{type:"email",class:r(["form-control",{"is-invalid":e.individualFormErrors.gmail}]),"onUpdate:modelValue":l[8]||(l[8]=i=>e.individualForm.gmail=i)},null,2),[[_,e.individualForm.gmail]]),e.individualFormErrors.gmail?(d(),n("div",Js,t(e.individualFormErrors.gmail),1)):u("",!0)]),s("div",Qs,[Xs,m(s("input",{type:"text",class:r(["form-control",{"is-invalid":e.individualFormErrors.pak_visa_password}]),"onUpdate:modelValue":l[9]||(l[9]=i=>e.individualForm.pak_visa_password=i)},null,2),[[_,e.individualForm.pak_visa_password]]),e.individualFormErrors.pak_visa_password?(d(),n("div",Ys,t(e.individualFormErrors.pak_visa_password),1)):u("",!0)]),s("div",$s,[se,m(s("input",{type:"gmail",class:r(["form-control",{"is-invalid":e.individualFormErrors.gmail_password}]),"onUpdate:modelValue":l[10]||(l[10]=i=>e.individualForm.gmail_password=i)},null,2),[[_,e.individualForm.gmail_password]]),e.individualFormErrors.gmail_password?(d(),n("div",ee,t(e.individualFormErrors.gmail_password),1)):u("",!0)]),s("div",ie,[le,b(p,{modelValue:e.individualForm.gender,"onUpdate:modelValue":l[11]||(l[11]=i=>e.individualForm.gender=i),options:e.genderOptions,searchable:!0,class:r({"invalid-bg":e.individualFormErrors.gender})},null,8,["modelValue","options","class"]),e.individualFormErrors.gender?(d(),n("div",te,t(e.individualFormErrors.gender),1)):u("",!0)]),s("div",oe,[ae,b(p,{modelValue:e.individualForm.referral,"onUpdate:modelValue":l[12]||(l[12]=i=>e.individualForm.referral=i),options:e.pluckedReferrals,searchable:!0,class:r({"invalid-bg":e.individualFormErrors.referral})},null,8,["modelValue","options","class"]),e.individualFormErrors.referral?(d(),n("div",re,t(e.individualFormErrors.referral),1)):u("",!0)])]),s("button",{type:"button",class:"btn btn-success mt-3",onClick:l[13]||(l[13]=(...i)=>a.submitIndividualForm&&a.submitIndividualForm(...i)),disabled:e.individualFormStatus===0},t(e.individualFormStatus===1?"Save":"Saving..."),9,de)])])])])])])])])}const he=E(R,[["render",ne]]);export{he as default};

import g from"./Master-6996375c.js";import{s as F}from"./multiselect-8c87406f.js";import{Z as k}from"./main-cfe26257.js";import{_ as y,a as _,r as w,o as a,c as d,b as s,t as o,h as E,F as V,g as T,i as c,v as m,n as r,j as u,d as h}from"./app-e769094c.js";const R={layout:g,components:{Multiselect:F,Datepicker:k},props:["country"],created(){this.fetchRecords(),this.referralsPluck(),this.employeesPluck()},data(){return{dataTable:null,selectedVisa:null,selectedVisa:{},pluckedReferrals:[],pluckedEmployees:[],tab:"single",individualForm:{id:"",full_name:"",phone_number:"",status:"",amount:"",tracking_id:"",visa_fee:"",gmail:"",pak_visa_password:"",gmail_password:"",gender:"",date:"",family_members:1,referral:"",referral_commission:"",employee:[]},individualFormErrors:{},formErrors:{},individualFormStatus:1,statusOptions:["Initial","Applied","Refunded","Rejected","Approved"],genderOptions:["Male","Female","Other"],VisasRecords:[],filters:{full_name:"",tracking_id:"",gmail:"",phone_number:""}}},mounted(){this.$nextTick(()=>{this.initializeDataTable()})},methods:{submitIndividualForm(){this.validateIndividualForm(),!(Object.keys(this.individualFormErrors).length>0)&&(this.individualForm.referral==null||this.individualForm.referral==""||this.individualForm.referral==null?this.individualForm.referral="":this.individualForm.referral=this.individualForm.referral,this.individualFormStatus=0,_.post(route("api.individual.customer.store"),this.individualForm,{headers:{Authorization:"Bearer "+this.$page.props.auth_token}}).then(()=>{toastr.success("Record saved successfully."),this.$refs.closeThisModal.click(),this.fetchRecords(),this.individualFormStatus=1}).catch(t=>{this.individualFormStatus=1,toastr.error(t.response.data.message),t.response.data.errors&&(this.formErrors=t.response.data.errors)}))},fetchRecords(){_.get(route("api.individual.customer.fetch"),{headers:{Authorization:"Bearer "+this.$page.props.auth_token}}).then(t=>{this.VisasRecords=t.data,this.dataTable&&(this.dataTable.destroy(),this.dataTable=null),this.$nextTick(()=>{this.initializeDataTable()})}).catch(t=>{toastr.error(t.response.data.message)})},initializeDataTable(){this.$nextTick(()=>{this.dataTable=$("#ledgerTable").DataTable({responsive:!0,autoWidth:!1,paging:!0,searching:!0,ordering:!0,lengthMenu:[10,25,50,100],language:{search:"Search:",lengthMenu:"Show _MENU_ entries",info:"Showing _START_ to _END_ of _TOTAL_ entries",paginate:{first:"First",last:"Last",next:"Next",previous:"Previous"}}})})},getRowClass(t){switch(t){case"Applied":return"bg-light-gray";case"Refunded":return"bg-orange";case"Rejected":return"bg-red";case"Approved":return"bg-green";default:return""}},openModal(t){this.selectedVisa=t,new bootstrap.Modal(document.getElementById("visaModal")).show()},editRecord(t){this.clearFields(),this.individualForm={...t}},clearFields(){this.individualForm={id:"",full_name:"",phone_number:"",status:"",amount:"",tracking_id:"",visa_fee:"",gmail:"",pak_visa_password:"",gmail_password:"",gender:"",date:"",family_members:1,referral:"",referral_commission:"",employee:[]},this.individualFormErrors={}},deleteThis(t){_.delete(route("api.customer.visa.record.delete",t)).then(()=>{this.fetchRecords(),toastr.success("Transaction entry deleted successfully.")}).catch(l=>{console.error(l)})},validateIndividualForm(){this.individualFormErrors={},["full_name","phone_number","status","amount","visa_fee","tracking_id","gmail","pak_visa_password","gmail_password","gender","date"].forEach(l=>{this.individualForm[l]||(this.individualFormErrors[l]=`${l.replace(/_/g," ")} is required`)}),this.individualForm.amount&&this.individualForm.visa_fee&&parseFloat(this.individualForm.amount)<=parseFloat(this.individualForm.visa_fee)&&(this.individualFormErrors.amount="Amount must be greater than Visa Fee")},referralsPluck(){_.get(route("api.referrals.pluck"),{headers:{Authorization:"Bearer "+this.$page.props.auth_token}}).then(t=>{this.pluckedReferrals=t.data}).catch(t=>{toastr.error(t.response.data.message)})},employeesPluck(){_.get(route("api.employees.pluck"),{headers:{Authorization:"Bearer "+this.$page.props.auth_token}}).then(t=>{this.pluckedEmployees=t.data}).catch(t=>{toastr.error(t.response.data.message)})}}},x={id:"main",class:"main"},C={class:"pagetitle d-flex justify-content-between"},A={class:"theme-text-color"},M={class:"breadcrumb"},S=s("li",{class:"breadcrumb-item"},[s("a",{href:"dashboard"},"TTC Global")],-1),I={class:"breadcrumb-item"},P=s("li",{class:"breadcrumb-item active"},"Individual Visas",-1),D=s("i",{class:"bi bi-plus-lg"},null,-1),U={class:"section"},N={class:"card"},B={class:"card-body"},z=s("h5",{class:"card-title theme-text-color"}," Individual Records ",-1),O={id:"ledgerTable",class:"table"},G=s("thead",null,[s("tr",null,[s("th",null,"#"),s("th",null,"Added By"),s("th",null,"Name"),s("th",null,"Phone #"),s("th",null,"Status"),s("th",null,"Amount"),s("th",null,"Tracking ID"),s("th",null,"Actions")])],-1),j={class:"text-white"},L=["onClick"],Z=["onClick"],q=s("i",{class:"bi bi-pencil"},null,-1),W=[q],H={class:"modal fade",id:"visaModal",tabindex:"-1","aria-labelledby":"modalTitle","aria-hidden":"true"},J={class:"modal-dialog"},K={class:"modal-content"},Q={class:"modal-header"},X={class:"modal-title",id:"modalTitle"},Y=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),ss={class:"modal-body"},es={class:"table table-striped"},is=s("th",{scope:"row"},"Phone Number",-1),ls=s("th",{scope:"row"},"Status",-1),os=s("th",{scope:"row"},"Amount",-1),ts=s("th",{scope:"row"},"Visa Fee",-1),rs=s("th",{scope:"row"},"Tracking ID",-1),as=s("th",{scope:"row"},"Email",-1),ds=s("th",{scope:"row"},"Gender",-1),ns=s("th",{scope:"row"},"Date",-1),us=s("th",{scope:"row"},"Pak Visa Password",-1),cs=s("th",{scope:"row"},"Gmail Password",-1),ms={class:"modal fade",id:"visarecordmodal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},_s={class:"modal-dialog modal-lg"},vs={class:"modal-content"},hs={class:"modal-header"},ps=s("div",{class:"section-title"},[s("h5",{class:"c-theme-red"}," Individual Apply Form ")],-1),bs={ref:"closeThisModal",type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},fs={class:"modal-body"},gs={class:"tab-content"},Fs={class:"row g-3"},ks={class:"col-12 col-md-6"},ys=s("label",{class:"form-label"},o("Date"),-1),ws={key:0,class:"invalid-feedback"},Es={class:"col-md-6 col-12"},Vs=s("label",{for:"individual_full_name",class:"form-label"},"Full Name",-1),Ts={key:0,class:"invalid-feedback"},Rs={class:"col-md-6 col-12"},xs=s("label",{for:"individual_phone_number",class:"form-label"},"Phone Number",-1),Cs={key:0,class:"invalid-feedback"},As={class:"col-md-6 col-12"},Ms=s("label",{for:"individual_status",class:"form-label"},"Status",-1),Ss={key:0,class:"invalid-feedback"},Is={class:"col-md-6 col-12"},Ps=s("label",{for:"individual_tracking_id",class:"form-label"},"Tracking ID",-1),Ds={key:0,class:"invalid-feedback"},Us={class:"col-md-6 col-12"},Ns=s("label",{for:"individual_amount",class:"form-label"},"Amount",-1),Bs={key:0,class:"invalid-feedback"},zs={class:"col-md-6 col-12"},Os=s("label",{for:"visa_fee",class:"form-label"},"Visa Fee",-1),Gs={key:0,class:"invalid-feedback"},js={class:"col-md-6 col-12"},Ls=s("label",{for:"individual_gmail",class:"form-label"},"Gmail",-1),Zs={key:0,class:"invalid-feedback"},qs={class:"col-md-6 col-12"},Ws=s("label",{for:"individual_pak_visa_password",class:"form-label"},"Pak Visa Password",-1),Hs={key:0,class:"invalid-feedback"},Js={class:"col-md-6 col-12"},Ks=s("label",{for:"individual_gmail_password",class:"form-label"},"Gmail Password",-1),Qs={key:0,class:"invalid-feedback"},Xs={class:"col-md-6 col-12"},Ys=s("label",{for:"individual_gender",class:"form-label"},"Gender",-1),$s={key:0,class:"invalid-feedback"},se={class:"col-md-6 col-12"},ee=s("label",{for:"referral",class:"form-label"},"Referrals",-1),ie={key:0,class:"invalid-feedback"},le=["disabled"];function oe(t,l,p,te,e,n){const v=w("Multiselect");return a(),d("main",x,[s("div",C,[s("div",null,[s("h1",A,o(p.country),1),s("nav",null,[s("ol",M,[S,s("li",I,o(p.country),1),P])])]),s("div",null,[s("button",{class:"btn btn-success mt-3","data-bs-toggle":"modal","data-bs-target":"#visarecordmodal",onClick:l[0]||(l[0]=(...i)=>n.clearFields&&n.clearFields(...i))},[D,E(" Add New Record ")])])]),s("section",U,[s("div",N,[s("div",B,[z,s("table",O,[G,s("tbody",j,[(a(!0),d(V,null,T(e.VisasRecords,(i,b)=>(a(),d("tr",{key:i.id},[s("td",{class:r(n.getRowClass(i.status))},o(b+1),3),s("td",{class:r(n.getRowClass(i.status))},o(i.added_by_user),3),s("td",{class:r(n.getRowClass(i.status))},[s("a",{href:"#",class:"theme-text-color",onClick:f=>n.openModal(i)},o(i.full_name),9,L)],2),s("td",{class:r(n.getRowClass(i.status))},o(i.phone_number),3),s("td",{class:r(n.getRowClass(i.status))},o(i.status),3),s("td",{class:r(n.getRowClass(i.status))},o(i.amount),3),s("td",{class:r(n.getRowClass(i.status))},o(i.tracking_id),3),s("td",{class:r(n.getRowClass(i.status))},[s("button",{class:"btn btn-sm btn-warning","data-bs-toggle":"modal","data-bs-target":"#visarecordmodal",onClick:f=>n.editRecord(i)},W,8,Z)],2)]))),128))])])])]),s("div",H,[s("div",J,[s("div",K,[s("div",Q,[s("h5",X,o(e.selectedVisa.full_name),1),Y]),s("div",ss,[s("table",es,[s("tbody",null,[s("tr",null,[is,s("td",null,o(e.selectedVisa.phone_number),1)]),s("tr",null,[ls,s("td",null,o(e.selectedVisa.status),1)]),s("tr",null,[os,s("td",null,o(e.selectedVisa.amount),1)]),s("tr",null,[ts,s("td",null,o(e.selectedVisa.visa_fee),1)]),s("tr",null,[rs,s("td",null,o(e.selectedVisa.tracking_id),1)]),s("tr",null,[as,s("td",null,o(e.selectedVisa.gmail),1)]),s("tr",null,[ds,s("td",null,o(e.selectedVisa.gender),1)]),s("tr",null,[ns,s("td",null,o(e.selectedVisa.date),1)]),s("tr",null,[us,s("td",null,o(e.selectedVisa.pak_visa_password),1)]),s("tr",null,[cs,s("td",null,o(e.selectedVisa.gmail_password),1)])])])])])])]),s("div",ms,[s("div",_s,[s("div",vs,[s("div",hs,[ps,s("button",bs,null,512)]),s("div",fs,[s("div",gs,[s("div",null,[s("div",Fs,[s("div",ks,[ys,c(s("input",{type:"date",class:r(["form-control",{"is-invalid":e.individualFormErrors.date}]),"onUpdate:modelValue":l[1]||(l[1]=i=>e.individualForm.date=i)},null,2),[[m,e.individualForm.date]]),e.individualFormErrors.date?(a(),d("div",ws,o(e.individualFormErrors.date),1)):u("",!0)]),s("div",Es,[Vs,c(s("input",{type:"text",class:r(["form-control",{"is-invalid":e.individualFormErrors.full_name}]),"onUpdate:modelValue":l[2]||(l[2]=i=>e.individualForm.full_name=i)},null,2),[[m,e.individualForm.full_name]]),e.individualFormErrors.full_name?(a(),d("div",Ts,o(e.individualFormErrors.full_name),1)):u("",!0)]),s("div",Rs,[xs,c(s("input",{type:"number",class:r(["form-control",{"is-invalid":e.individualFormErrors.phone_number}]),"onUpdate:modelValue":l[3]||(l[3]=i=>e.individualForm.phone_number=i)},null,2),[[m,e.individualForm.phone_number]]),e.individualFormErrors.phone_number?(a(),d("div",Cs,o(e.individualFormErrors.phone_number),1)):u("",!0)]),s("div",As,[Ms,h(v,{modelValue:e.individualForm.status,"onUpdate:modelValue":l[4]||(l[4]=i=>e.individualForm.status=i),options:e.statusOptions,searchable:!0,class:r({"is-invalid":e.individualFormErrors.status})},null,8,["modelValue","options","class"]),e.individualFormErrors.status?(a(),d("div",Ss,o(e.individualFormErrors.status),1)):u("",!0)]),s("div",Is,[Ps,c(s("input",{type:"text",class:r(["form-control",{"is-invalid":e.individualFormErrors.tracking_id}]),"onUpdate:modelValue":l[5]||(l[5]=i=>e.individualForm.tracking_id=i)},null,2),[[m,e.individualForm.tracking_id]]),e.individualFormErrors.tracking_id?(a(),d("div",Ds,o(e.individualFormErrors.tracking_id),1)):u("",!0)]),s("div",Us,[Ns,c(s("input",{type:"number",class:r(["form-control",{"is-invalid":e.individualFormErrors.amount}]),"onUpdate:modelValue":l[6]||(l[6]=i=>e.individualForm.amount=i)},null,2),[[m,e.individualForm.amount]]),e.individualFormErrors.amount?(a(),d("div",Bs,o(e.individualFormErrors.amount),1)):u("",!0)]),s("div",zs,[Os,c(s("input",{type:"number",class:r(["form-control",{"is-invalid":e.individualFormErrors.visa_fee}]),"onUpdate:modelValue":l[7]||(l[7]=i=>e.individualForm.visa_fee=i)},null,2),[[m,e.individualForm.visa_fee]]),e.individualFormErrors.visa_fee?(a(),d("div",Gs,o(e.individualFormErrors.visa_fee),1)):u("",!0)]),s("div",js,[Ls,c(s("input",{type:"email",class:r(["form-control",{"is-invalid":e.individualFormErrors.gmail}]),"onUpdate:modelValue":l[8]||(l[8]=i=>e.individualForm.gmail=i)},null,2),[[m,e.individualForm.gmail]]),e.individualFormErrors.gmail?(a(),d("div",Zs,o(e.individualFormErrors.gmail),1)):u("",!0)]),s("div",qs,[Ws,c(s("input",{type:"text",class:r(["form-control",{"is-invalid":e.individualFormErrors.pak_visa_password}]),"onUpdate:modelValue":l[9]||(l[9]=i=>e.individualForm.pak_visa_password=i)},null,2),[[m,e.individualForm.pak_visa_password]]),e.individualFormErrors.pak_visa_password?(a(),d("div",Hs,o(e.individualFormErrors.pak_visa_password),1)):u("",!0)]),s("div",Js,[Ks,c(s("input",{type:"gmail",class:r(["form-control",{"is-invalid":e.individualFormErrors.gmail_password}]),"onUpdate:modelValue":l[10]||(l[10]=i=>e.individualForm.gmail_password=i)},null,2),[[m,e.individualForm.gmail_password]]),e.individualFormErrors.gmail_password?(a(),d("div",Qs,o(e.individualFormErrors.gmail_password),1)):u("",!0)]),s("div",Xs,[Ys,h(v,{modelValue:e.individualForm.gender,"onUpdate:modelValue":l[11]||(l[11]=i=>e.individualForm.gender=i),options:e.genderOptions,searchable:!0,class:r({"invalid-bg":e.individualFormErrors.gender})},null,8,["modelValue","options","class"]),e.individualFormErrors.gender?(a(),d("div",$s,o(e.individualFormErrors.gender),1)):u("",!0)]),s("div",se,[ee,h(v,{modelValue:e.individualForm.referral,"onUpdate:modelValue":l[12]||(l[12]=i=>e.individualForm.referral=i),options:e.pluckedReferrals,searchable:!0,class:r({"invalid-bg":e.individualFormErrors.referral})},null,8,["modelValue","options","class"]),e.individualFormErrors.referral?(a(),d("div",ie,o(e.individualFormErrors.referral),1)):u("",!0)])]),s("button",{type:"button",class:"btn btn-success mt-3",onClick:l[13]||(l[13]=(...i)=>n.submitIndividualForm&&n.submitIndividualForm(...i)),disabled:e.individualFormStatus===0},o(e.individualFormStatus===1?"Save":"Saving..."),9,le)])])])])])])])])}const ue=y(R,[["render",oe]]);export{ue as default};

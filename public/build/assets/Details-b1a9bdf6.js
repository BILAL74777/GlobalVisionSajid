import D from"./Master-7226e560.js";import{s as M}from"./multiselect-ae25d6d5.js";import{_ as k,r as C,o as c,c as d,b as t,t as e,d as g,F as m,h as b,e as n,j as x,f as F,p as S,g as V}from"./app-76166c72.js";const w={layout:D,components:{Multiselect:M},props:["referral","transactions","groupedData"],data(){return{transactionDetails:null,selectedYear:new Date().getFullYear(),selectedMonth:new Date().getMonth()+1,years:Array.from({length:10},(l,r)=>new Date().getFullYear()-r),months:[{value:1,label:"January"},{value:2,label:"February"},{value:3,label:"March"},{value:4,label:"April"},{value:5,label:"May"},{value:6,label:"June"},{value:7,label:"July"},{value:8,label:"August"},{value:9,label:"September"},{value:10,label:"October"},{value:11,label:"November"},{value:12,label:"December"}],neatData:[]}},mounted(){this.$nextTick(()=>{$("#transactionsTable").DataTable({responsive:!0,autoWidth:!1,paging:!0,searching:!0,ordering:!0,lengthMenu:[15,30,100],language:{search:"Search:",lengthMenu:"Show _MENU_ entries",info:"Showing _START_ to _END_ of _TOTAL_ entries",paginate:{first:"First",last:"Last",next:"Next",previous:"Previous"}}})})},methods:{formatCurrency(l){return` ${parseFloat(l).toFixed(2)}`},showDetails(l){const r=l.transactions[0].visa;r&&(this.transactionDetails={...r,familyMembers:[r,...l.transactions[0].familyMembers]})},systemFee(l){const r=Number((l==null?void 0:l.total_cash_in)??0),u=Number((l==null?void 0:l.total_cash_out)??0),h=Number((l==null?void 0:l.total_commission_amount)??0);return r-u-h}},computed:{filteredGroupedData(){return this.groupedData.filter(l=>{var h,o,i;const r=(i=(o=(h=l.transactions)==null?void 0:h[0])==null?void 0:o.visa)==null?void 0:i.date;if(!r)return!1;const u=new Date(r);return u.getFullYear()===this.selectedYear&&u.getMonth()+1===this.selectedMonth})},totalCashIn(){return this.filteredGroupedData.reduce((l,r)=>l+Number(r.total_cash_in??0),0)},totalCashOut(){return this.filteredGroupedData.reduce((l,r)=>l+Number(r.total_cash_out??0),0)},totalCommissionAmount(){return this.filteredGroupedData.reduce((l,r)=>l+Number(r.total_commission_amount??0),0)},totalSystemAmount(){return this.totalCashIn-this.totalCashOut-this.totalCommissionAmount}}},a=l=>(S("data-v-a8a4b945"),l=l(),V(),l),N={id:"main",class:"main"},A={class:"pagetitle d-flex justify-content-between"},T={class:"theme-text-color"},I=F('<nav data-v-a8a4b945><ol class="breadcrumb" data-v-a8a4b945><li class="breadcrumb-item" data-v-a8a4b945><a href="dashboard" data-v-a8a4b945>Global Vision</a></li><li class="breadcrumb-item" data-v-a8a4b945>Referral</li><li class="breadcrumb-item active" data-v-a8a4b945>Details</li></ol></nav>',1),G={class:"section"},P={class:"card p-3"},Y={class:"d-flex gap-2 align-items-center"},O={class:"section"},L={class:"card"},B={class:"card-body"},E=a(()=>t("h5",{class:"card-title theme-text-color"},"Transactions",-1)),J={class:"table-responsive"},R={class:"table table-striped",id:"transactionsTable"},U=a(()=>t("thead",null,[t("tr",null,[t("th",null,"Transaction Type"),t("th",null,"Phone #"),t("th",null,"Tracking ID"),t("th",null,"Actual Amount"),t("th",null,"Visa Fee"),t("th",null,"System Amount"),t("th",null,"Referral Percentage")])],-1)),j=["onClick"],W={key:0},q={style:{color:"green"}},z={key:1},H=a(()=>t("br",null,null,-1)),K={style:{color:"green"}},Q={class:"table-success"},X=a(()=>t("td",{colspan:"3"},[t("strong",null,"Total")],-1)),Z={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true","data-bs-backdrop":"static","data-bs-keyboard":"false"},tt={class:"modal-dialog modal-lg",role:"document"},et={class:"modal-content"},st=a(()=>t("div",{class:"modal-header"},[t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),at={key:0,class:"modal-body"},lt={class:"row"},nt={class:"text-success"},ot={key:0,class:"col-12"},it={class:"card"},rt={class:"card-body p-3"},ct=a(()=>t("strong",null,"Full Name:",-1)),dt=a(()=>t("strong",null,"Phone:",-1)),ut=a(()=>t("strong",null,"Tracking ID:",-1)),_t=a(()=>t("strong",null,"Status:",-1)),ht=a(()=>t("strong",null,"Amount:",-1)),mt=a(()=>t("strong",null,"Visa Fee:",-1)),bt=a(()=>t("strong",null,"Gmail:",-1)),ft=a(()=>t("strong",null,"Pak Visa Password:",-1)),yt=a(()=>t("strong",null,"Gender:",-1)),vt={class:"card"},pt={class:"card-header text-success"},gt={class:"card-body p-3"},Dt=a(()=>t("strong",null,"Full Name:",-1)),Mt=a(()=>t("strong",null,"Phone:",-1)),kt=a(()=>t("strong",null,"Tracking ID:",-1)),Ct=a(()=>t("strong",null,"Status:",-1)),xt=a(()=>t("strong",null,"Amount:",-1)),Ft=a(()=>t("strong",null,"Visa Fee:",-1)),St=a(()=>t("strong",null,"Gmail:",-1)),Vt=a(()=>t("strong",null,"Pak Visa Password:",-1)),wt=a(()=>t("strong",null,"Gender:",-1)),Nt={class:"card"},At={class:"card-header text-success"},Tt={class:"card-body p-3"},It=a(()=>t("strong",null,"Full Name:",-1)),Gt=a(()=>t("strong",null,"Phone:",-1)),Pt=a(()=>t("strong",null,"Tracking ID:",-1)),Yt=a(()=>t("strong",null,"Status:",-1)),Ot=a(()=>t("strong",null,"Amount:",-1)),Lt=a(()=>t("strong",null,"Visa Fee:",-1)),Bt=a(()=>t("strong",null,"Gmail:",-1)),Et=a(()=>t("strong",null,"Pak Visa Password:",-1)),Jt=a(()=>t("strong",null,"Gender:",-1));function Rt(l,r,u,h,o,i){var v,p;const y=C("Multiselect");return c(),d("main",N,[t("div",A,[t("div",null,[t("h1",T,e(u.referral.name),1),I])]),t("section",G,[t("div",P,[t("div",Y,[g(y,{modelValue:o.selectedYear,"onUpdate:modelValue":r[0]||(r[0]=s=>o.selectedYear=s),options:o.years,searchable:!0,placeholder:"Select Year"},null,8,["modelValue","options"]),g(y,{modelValue:o.selectedMonth,"onUpdate:modelValue":r[1]||(r[1]=s=>o.selectedMonth=s),options:o.months,searchable:!0,placeholder:"Select Month",label:"label","track-by":"value"},null,8,["modelValue","options"])])])]),t("section",O,[t("div",L,[t("div",B,[E,t("div",J,[t("table",R,[U,t("tbody",null,[(c(!0),d(m,null,b(i.filteredGroupedData,s=>{var _;return c(),d("tr",{key:s.parent_id},[t("td",{"data-bs-toggle":"modal","data-bs-target":"#exampleModal",onClick:f=>i.showDetails(s),style:{"font-weight":"bold","text-align":"left",cursor:"pointer"}},[s.transactions[0].visa&&s.transactions[0].visa.entry_type==="Family"?(c(),d("div",W,[t("span",null,e(s.transactions[0].visa.family_name),1),t("div",q,[t("b",null,e(s.transactions[0].visa.full_name),1),(c(!0),d(m,null,b(s.transactions[0].familyMembers,f=>(c(),d("div",{key:f.id},[t("b",null,e(f.full_name),1)]))),128))])])):(c(),d("div",z,[n(" Individual "),H,t("b",K,e((_=s.transactions[0].visa)==null?void 0:_.full_name),1)]))],8,j),t("td",null,e(s.transactions[0].visa.phone_number),1),t("td",null,e(s.transactions[0].visa.tracking_id),1),t("td",null,e(i.formatCurrency(s.total_cash_in)),1),t("td",null,e(i.formatCurrency(s.total_cash_out)),1),t("td",null," Sys.amount "+e(i.formatCurrency(i.systemFee(s))),1),t("td",null,e(i.formatCurrency(s.total_commission_amount)),1)])}),128))]),t("tfoot",null,[t("tr",Q,[X,t("td",null,e(i.formatCurrency(i.totalCashIn)),1),t("td",null,e(i.formatCurrency(i.totalCashOut)),1),t("td",null,e(i.formatCurrency(i.totalSystemAmount)),1),t("td",null,e(i.formatCurrency(i.totalCommissionAmount)),1)])])])])])])]),t("div",Z,[t("div",tt,[t("div",et,[st,(p=(v=o.transactionDetails)==null?void 0:v.familyMembers)!=null&&p.length?(c(),d("div",at,[t("div",lt,[t("h4",nt,e(o.transactionDetails.family_name??"Individual Apply"),1),o.transactionDetails.familyMembers.length===1?(c(),d("div",ot,[t("div",it,[t("div",rt,[t("p",null,[ct,n(" "+e(o.transactionDetails.familyMembers[0].full_name),1)]),t("p",null,[dt,n(" "+e(o.transactionDetails.familyMembers[0].phone_number),1)]),t("p",null,[ut,n(" "+e(o.transactionDetails.familyMembers[0].tracking_id),1)]),t("p",null,[_t,n(" "+e(o.transactionDetails.familyMembers[0].status),1)]),t("p",null,[ht,n(" "+e(i.formatCurrency(o.transactionDetails.familyMembers[0].amount)),1)]),t("p",null,[mt,n(" "+e(i.formatCurrency(o.transactionDetails.familyMembers[0].visa_fee)),1)]),t("p",null,[bt,n(" "+e(o.transactionDetails.familyMembers[0].gmail),1)]),t("p",null,[ft,n(" "+e(o.transactionDetails.familyMembers[0].pak_visa_password),1)]),t("p",null,[yt,n(" "+e(o.transactionDetails.familyMembers[0].gender),1)])])])])):o.transactionDetails.familyMembers.length===2?(c(!0),d(m,{key:1},b(o.transactionDetails.familyMembers,(s,_)=>(c(),d("div",{class:"col-md-6",key:s.id},[t("div",vt,[t("div",pt,[t("b",null,"Member #"+e(_+1),1)]),t("div",gt,[t("p",null,[Dt,n(" "+e(s.full_name),1)]),t("p",null,[Mt,n(" "+e(s.phone_number),1)]),t("p",null,[kt,n(" "+e(s.tracking_id),1)]),t("p",null,[Ct,n(" "+e(s.status),1)]),t("p",null,[xt,n(" "+e(i.formatCurrency(s.amount)),1)]),t("p",null,[Ft,n(" "+e(i.formatCurrency(s.visa_fee)),1)]),t("p",null,[St,n(" "+e(s.gmail),1)]),t("p",null,[Vt,n(" "+e(s.pak_visa_password),1)]),t("p",null,[wt,n(" "+e(s.gender),1)])])])]))),128)):(c(!0),d(m,{key:2},b(o.transactionDetails.familyMembers,(s,_)=>(c(),d("div",{class:"col-md-6",key:s.id},[t("div",Nt,[t("div",At,[t("b",null,"Member #"+e(_+1),1)]),t("div",Tt,[t("p",null,[It,n(" "+e(s.full_name),1)]),t("p",null,[Gt,n(" "+e(s.phone_number),1)]),t("p",null,[Pt,n(" "+e(s.tracking_id),1)]),t("p",null,[Yt,n(" "+e(s.status),1)]),t("p",null,[Ot,n(" "+e(i.formatCurrency(s.amount)),1)]),t("p",null,[Lt,n(" "+e(i.formatCurrency(s.visa_fee)),1)]),t("p",null,[Bt,n(" "+e(s.gmail),1)]),t("p",null,[Et,n(" "+e(s.pak_visa_password),1)]),t("p",null,[Jt,n(" "+e(s.gender),1)])])])]))),128))])])):x("",!0)])])])])}const qt=k(w,[["render",Rt],["__scopeId","data-v-a8a4b945"]]);export{qt as default};

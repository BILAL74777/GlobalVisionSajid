import{_ as b,a as u,o as a,c as i,b as e,h as f,F as v,g as F,w as y,i as c,v as m,n as _,t as l,j as h,e as E}from"./app-fc74f043.js";import g from"./Master-5dea74d0.js";const R={layout:g,props:["country"],data(){return{referrals:[],referralForm:{name:"",email:"",phone:"",address:"",id:"",commission:""},referralErrors:{},referralStatus:1}},created(){this.fetchReferrals()},methods:{openModal(t=null){t?this.referralForm={...t}:this.clearFields();const o=document.getElementById("referralModal");new bootstrap.Modal(o).show()},clearFields(){this.referralForm={name:"",email:"",phone:"",address:"",id:null,commission:""},this.referralErrors={}},editReferral(t){this.openModal(t)},fetchReferrals(){u.get(route("api.referrals.fetch"),{headers:{Authorization:"Bearer "+this.$page.props.auth_token}}).then(t=>{this.referrals=t.data}).catch(t=>{console.error(t)})},validateReferralForm(){this.referralErrors={},this.referralForm.name||(this.referralErrors.name="Name is required."),this.referralForm.email||(this.referralErrors.email="Email is required."),this.referralForm.phone||(this.referralErrors.phone="Phone Number is required."),this.referralForm.commission||(this.referralErrors.commission="Commission is required.")},submitReferral(){if(this.validateReferralForm(),Object.keys(this.referralErrors).length>0)return;this.referralStatus=0;const t=(this.referralForm.id,route("api.referrals.store"));u({method:"post",url:t,data:this.referralForm,headers:{Authorization:"Bearer "+this.$page.props.auth_token}}).then(()=>{toastr.success("Referral saved successfully."),this.fetchReferrals(),this.referralStatus=1,this.clearFields(),this.$refs.closeModal.click()}).catch(n=>{this.referralStatus=1,toastr.error(n.response.data.message),n.response.data.errors&&(this.referralErrors=n.response.data.errors)})},deleteReferral(t){u.delete(route("api.referrals.delete",t)).then(()=>{toastr.success("Referral deleted successfully."),this.fetchReferrals()}).catch(o=>{console.error(o)})}}},k={id:"main",class:"main"},x={class:"pagetitle d-flex justify-content-between"},M=E('<div><h1 class="theme-text-color">Referrals</h1><nav><ol class="breadcrumb"><li class="breadcrumb-item"><a href="dashboard">Global Vision</a></li><li class="breadcrumb-item active">Referrals</li></ol></nav></div>',1),N=e("i",{class:"bi bi-plus-lg"},null,-1),S={class:"section"},w={class:"card"},V={class:"card-body"},C=e("h5",{class:"card-title theme-text-color"}," Referral Records ",-1),A={class:"table-responsive"},B={class:"table table-striped"},I=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Name"),e("th",{scope:"col"},"Email"),e("th",{scope:"col"},"Commission"),e("th",{scope:"col"},"Phone"),e("th",{scope:"col"},"Address"),e("th",{scope:"col"},"Actions")])],-1),U={scope:"row"},q=["href"],j=["onClick"],z=e("i",{class:"bi bi-pencil"},null,-1),P=[z],D={class:"modal fade",id:"referralModal",tabindex:"-1","aria-hidden":"true","data-bs-backdrop":"static","data-bs-keyboard":"false"},O={class:"modal-dialog"},T={class:"modal-content"},G={class:"modal-header"},L=e("h5",{class:"modal-title"},"Referral Registration",-1),H={type:"button",ref:"closeModal",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},J={class:"modal-body"},K={class:"row g-3"},Q={class:"col-12"},W=e("label",{for:"name",class:"form-label"},[f("Name"),e("i",{class:"text-danger"},"*")],-1),X={key:0,class:"invalid-feedback"},Y={class:"col-12"},Z=e("label",{class:"form-label"},[f("Commission"),e("i",{class:"text-danger"},"*")],-1),$={key:0,class:"invalid-feedback"},ee={class:"col-12"},se=e("label",{for:"phone",class:"form-label"},[f("Phone"),e("i",{class:"text-danger"},"*")],-1),re={key:0,class:"invalid-feedback"},oe={class:"col-12"},te=e("label",{for:"email",class:"form-label"},[f("Email "),e("i",{class:"text-danger"},"*")],-1),le={key:0,class:"invalid-feedback"},ae={class:"col-12"},ie=e("label",{for:"address",class:"form-label"},"Address (Optional)",-1),ne=["disabled"];function de(t,o,n,ce,s,d){return a(),i("main",k,[e("div",x,[M,e("div",null,[e("button",{class:"btn btn-success mt-3","data-bs-toggle":"modal","data-bs-target":"#referralModal",onClick:o[0]||(o[0]=(...r)=>d.clearFields&&d.clearFields(...r))},[N,f(" Add New Referral ")])])]),e("section",S,[e("div",w,[e("div",V,[C,e("div",A,[e("table",B,[I,e("tbody",null,[(a(!0),i(v,null,F(s.referrals,(r,p)=>(a(),i("tr",{key:r.id},[e("th",U,l(p+1),1),e("td",null,[e("a",{class:"theme-text-color",href:t.route("referral.details",r.id)},l(r.name),9,q)]),e("td",null,l(r.email),1),e("td",null,l(r.commission)+"%",1),e("td",null,l(r.phone||"N/A"),1),e("td",null,l(r.address||"N/A"),1),e("td",null,[e("button",{class:"btn btn-sm btn-warning",onClick:me=>d.editReferral(r)},P,8,j)])]))),128))])])])])]),e("div",D,[e("div",O,[e("div",T,[e("div",G,[L,e("button",H,null,512)]),e("div",J,[e("form",{onSubmit:o[6]||(o[6]=y((...r)=>d.submitReferral&&d.submitReferral(...r),["prevent"]))},[e("div",K,[e("div",Q,[W,c(e("input",{type:"text",class:_(["form-control",{"is-invalid":s.referralErrors.name}]),"onUpdate:modelValue":o[1]||(o[1]=r=>s.referralForm.name=r)},null,2),[[m,s.referralForm.name]]),s.referralErrors.name?(a(),i("div",X,l(s.referralErrors.name),1)):h("",!0)]),e("div",Y,[Z,c(e("input",{type:"number",class:_(["form-control",{"is-invalid":s.referralErrors.commission}]),"onUpdate:modelValue":o[2]||(o[2]=r=>s.referralForm.commission=r)},null,2),[[m,s.referralForm.commission]]),s.referralErrors.commission?(a(),i("div",$,l(s.referralErrors.commission),1)):h("",!0)]),e("div",ee,[se,c(e("input",{type:"text",class:_(["form-control",{"is-invalid":s.referralErrors.phone}]),"onUpdate:modelValue":o[3]||(o[3]=r=>s.referralForm.phone=r)},null,2),[[m,s.referralForm.phone]]),s.referralErrors.phone?(a(),i("div",re,l(s.referralErrors.phone),1)):h("",!0)]),e("div",oe,[te,c(e("input",{type:"email",class:"form-control","onUpdate:modelValue":o[4]||(o[4]=r=>s.referralForm.email=r)},null,512),[[m,s.referralForm.email]]),s.referralErrors.email?(a(),i("div",le,l(s.referralErrors.email),1)):h("",!0)]),e("div",ae,[ie,c(e("input",{type:"text",class:"form-control","onUpdate:modelValue":o[5]||(o[5]=r=>s.referralForm.address=r)},null,512),[[m,s.referralForm.address]])])]),e("button",{type:"submit",class:"btn btn-success mt-3",disabled:s.referralStatus===0},l(s.referralStatus===1?"Save Referral":"Saving..."),9,ne)],32)])])])])])])}const ue=b(R,[["render",de]]);export{ue as default};

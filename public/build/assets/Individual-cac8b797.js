import k from"./Master-c7b86318.js";import{s as y}from"./multiselect-bb7a507c.js";import{Z as w}from"./main-85c946de.js";import{_ as E,a as h,r as V,o as d,c as n,b as e,t,h as c,F as x,g as T,i as m,v as _,n as r,j as u,d as b}from"./app-45803b45.js";const R={layout:k,components:{Multiselect:y,Datepicker:w},props:["country"],created(){this.fetchRecords(),this.referralsPluck(),this.employeesPluck()},data(){return{today:this.getPakistanDate(),dataTable:null,selectedVisa:null,selectedVisa:{},pluckedReferrals:[],pluckedEmployees:[],tab:"single",individualForm:{id:"",full_name:"",phone_number:"",status:"",amount:"",tracking_id:"",visa_fee:"",gmail:"",pak_visa_password:"",gmail_password:"",gender:"",date:"",family_members:1,referral:"",referral_commission:"",employee:[]},individualFormErrors:{},formErrors:{},individualFormStatus:1,statusOptions:["Initial","Applied","Refunded","Rejected","Approved"],genderOptions:["Male","Female","Other"],VisasRecords:[],filters:{full_name:"",tracking_id:"",gmail:"",phone_number:""}}},mounted(){this.$nextTick(()=>{this.initializeDataTable()})},methods:{getPakistanDate(){let l=new Intl.DateTimeFormat("en-CA",{timeZone:"Asia/Karachi",year:"numeric",month:"2-digit",day:"2-digit"}).formatToParts(new Date),v=l.find(a=>a.type==="year").value,f=l.find(a=>a.type==="month").value,s=l.find(a=>a.type==="day").value;return`${v}-${f}-${s}`},submitIndividualForm(){this.validateIndividualForm(),!(Object.keys(this.individualFormErrors).length>0)&&(this.individualForm.referral==null||this.individualForm.referral==""||this.individualForm.referral==null?this.individualForm.referral="":this.individualForm.referral=this.individualForm.referral,this.individualFormStatus=0,h.post(route("api.individual.customer.store"),this.individualForm,{headers:{Authorization:"Bearer "+this.$page.props.auth_token}}).then(()=>{toastr.success("Record saved successfully."),this.$refs.closeThisModal.click(),this.fetchRecords(),this.individualFormStatus=1}).catch(o=>{this.individualFormStatus=1,toastr.error(o.response.data.message),o.response.data.errors&&(this.formErrors=o.response.data.errors)}))},fetchRecords(){h.get(route("api.individual.customer.fetch"),{headers:{Authorization:"Bearer "+this.$page.props.auth_token}}).then(o=>{this.VisasRecords=o.data,this.dataTable&&(this.dataTable.destroy(),this.dataTable=null),this.$nextTick(()=>{this.initializeDataTable()})}).catch(o=>{toastr.error(o.response.data.message)})},initializeDataTable(){this.$nextTick(()=>{this.dataTable=$("#ledgerTable").DataTable({responsive:!0,autoWidth:!1,paging:!0,searching:!0,ordering:!0,lengthMenu:[15,30,100],language:{search:"Search:",lengthMenu:"Show _MENU_ entries",info:"Showing _START_ to _END_ of _TOTAL_ entries",paginate:{first:"First",last:"Last",next:"Next",previous:"Previous"}}})})},getRowClass(o){switch(o){case"Applied":return"bg-light-gray";case"Refunded":return"bg-orange";case"Rejected":return"bg-red";case"Approved":return"bg-green";default:return""}},openModal(o){this.selectedVisa=o,new bootstrap.Modal(document.getElementById("visaModal")).show()},editRecord(o){this.clearFields(),this.individualForm={...o}},clearFields(){this.individualForm={id:"",full_name:"",phone_number:"",status:"",amount:"",tracking_id:"",visa_fee:"",gmail:"",pak_visa_password:"",gmail_password:"",gender:"",date:"",family_members:1,referral:"",referral_commission:"",employee:[]},this.individualFormErrors={}},deleteThis(o){h.delete(route("api.customer.visa.record.delete",o)).then(()=>{this.fetchRecords(),toastr.success("Transaction entry deleted successfully.")}).catch(l=>{console.error(l)})},validateIndividualForm(){this.individualFormErrors={},["full_name","phone_number","status","amount","visa_fee","tracking_id","gmail","pak_visa_password","gmail_password","gender","date"].forEach(l=>{this.individualForm[l]||(this.individualFormErrors[l]=`${l.replace(/_/g," ")} is required`)}),this.individualForm.amount&&this.individualForm.visa_fee&&parseFloat(this.individualForm.amount)<=parseFloat(this.individualForm.visa_fee)&&(this.individualFormErrors.amount="Amount must be greater than Visa Fee")},referralsPluck(){h.get(route("api.referrals.pluck"),{headers:{Authorization:"Bearer "+this.$page.props.auth_token}}).then(o=>{this.pluckedReferrals=o.data}).catch(o=>{toastr.error(o.response.data.message)})},employeesPluck(){h.get(route("api.employees.pluck"),{headers:{Authorization:"Bearer "+this.$page.props.auth_token}}).then(o=>{this.pluckedEmployees=o.data}).catch(o=>{toastr.error(o.response.data.message)})}}},C={id:"main",class:"main"},A={class:"pagetitle d-flex justify-content-between"},D={class:"theme-text-color"},M={class:"breadcrumb"},P=e("li",{class:"breadcrumb-item"},[e("a",{href:"dashboard"},"TTC Global")],-1),I={class:"breadcrumb-item"},S=e("li",{class:"breadcrumb-item active"},"Individual Visas",-1),U=e("i",{class:"bi bi-plus-lg"},null,-1),N={class:"section"},B={class:"card"},z={class:"card-body"},O=e("h5",{class:"card-title theme-text-color"},"Individual Records",-1),G={id:"ledgerTable",class:"table"},j=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Name"),e("th",null,"Phone #"),e("th",null,"Status"),e("th",null,"Amount"),e("th",null,"Tracking ID"),e("th",null,"Actions")])],-1),L={class:"text-white"},Z=["onClick"],q=["onClick"],K=e("i",{class:"bi bi-pencil"},null,-1),W=[K],H={class:"modal fade",id:"visaModal",tabindex:"-1","aria-labelledby":"modalTitle","aria-hidden":"true"},J={class:"modal-dialog"},Q={class:"modal-content"},X={class:"modal-header"},Y={class:"modal-title",id:"modalTitle"},ee=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),se={class:"modal-body"},ie={class:"table table-striped"},le=e("th",{scope:"row"},"Phone Number",-1),te=e("th",{scope:"row"},"Status",-1),oe=e("th",{scope:"row"},"Amount",-1),ae=e("th",{scope:"row"},"Visa Fee",-1),re=e("th",{scope:"row"},"Tracking ID",-1),de=e("th",{scope:"row"},"Email",-1),ne=e("th",{scope:"row"},"Gender",-1),ue=e("th",{scope:"row"},"Date",-1),ce=e("th",{scope:"row"},"Pak Visa Password",-1),me=e("th",{scope:"row"},"Gmail Password",-1),_e=e("th",{scope:"row"},"Applied By",-1),he={class:"modal fade",id:"visarecordmodal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},ve={class:"modal-dialog modal-lg"},pe={class:"modal-content"},be={class:"modal-header"},fe=e("div",{class:"section-title"},[e("h5",{class:"c-theme-red"},"Individual Apply Form")],-1),ge={ref:"closeThisModal",type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},Fe={class:"modal-body"},ke={class:"tab-content"},ye={class:"row g-3"},we={class:"col-12 col-md-6"},Ee=e("label",{class:"form-label"},[c(t("Date")),e("i",{class:"text-danger"},"*")],-1),Ve=["max"],xe={key:0,class:"invalid-feedback"},Te={class:"col-md-6 col-12"},Re=e("label",{for:"individual_full_name",class:"form-label"},[c("Full Name"),e("i",{class:"text-danger"},"*")],-1),Ce={key:0,class:"invalid-feedback"},Ae={class:"col-md-6 col-12"},De=e("label",{for:"individual_phone_number",class:"form-label"},[c("Phone Number"),e("i",{class:"text-danger"},"*")],-1),Me={key:0,class:"invalid-feedback"},Pe={class:"col-md-6 col-12"},Ie=e("label",{for:"individual_status",class:"form-label"},[c("Status"),e("i",{class:"text-danger"},"*")],-1),Se={key:0,class:"invalid-feedback"},Ue={class:"col-md-6 col-12"},Ne=e("label",{for:"individual_tracking_id",class:"form-label"},[c("Tracking ID"),e("i",{class:"text-danger"},"*")],-1),Be={key:0,class:"invalid-feedback"},ze={class:"col-md-6 col-12"},Oe=e("label",{for:"individual_amount",class:"form-label"},[c("Amount"),e("i",{class:"text-danger"},"*")],-1),Ge={key:0,class:"invalid-feedback"},je={class:"col-md-6 col-12"},Le=e("label",{for:"visa_fee",class:"form-label"},[c("Visa Fee"),e("i",{class:"text-danger"},"*")],-1),Ze={key:0,class:"invalid-feedback"},qe={class:"col-md-6 col-12"},Ke=e("label",{for:"individual_gmail",class:"form-label"},[c("Gmail"),e("i",{class:"text-danger"},"*")],-1),We={key:0,class:"invalid-feedback"},He={class:"col-md-6 col-12"},Je=e("label",{for:"individual_pak_visa_password",class:"form-label"},[c("Pak Visa Password"),e("i",{class:"text-danger"},"*")],-1),Qe={key:0,class:"invalid-feedback"},Xe={class:"col-md-6 col-12"},Ye=e("label",{for:"individual_gmail_password",class:"form-label"},[c("Gmail Password"),e("i",{class:"text-danger"},"*")],-1),$e={key:0,class:"invalid-feedback"},es={class:"col-md-6 col-12"},ss=e("label",{for:"individual_gender",class:"form-label"},[c("Gender"),e("i",{class:"text-danger"},"*")],-1),is={key:0,class:"invalid-feedback"},ls={class:"col-md-6 col-12"},ts=e("label",{for:"referral",class:"form-label"},"Referrals ",-1),os={key:0,class:"invalid-feedback"},as=["disabled"];function rs(o,l,v,f,s,a){const p=V("Multiselect");return d(),n("main",C,[e("div",A,[e("div",null,[e("h1",D,t(v.country),1),e("nav",null,[e("ol",M,[P,e("li",I,t(v.country),1),S])])]),e("div",null,[e("button",{class:"btn btn-success mt-3","data-bs-toggle":"modal","data-bs-target":"#visarecordmodal",onClick:l[0]||(l[0]=(...i)=>a.clearFields&&a.clearFields(...i))},[U,c(" Add New Record ")])])]),e("section",N,[e("div",B,[e("div",z,[O,e("table",G,[j,e("tbody",L,[(d(!0),n(x,null,T(s.VisasRecords,(i,g)=>(d(),n("tr",{key:i.id},[e("td",{class:r(a.getRowClass(i.status))},t(g+1),3),e("td",{class:r(a.getRowClass(i.status))},[e("a",{href:"#",class:r(["theme-text-color",a.getRowClass(i.status)]),onClick:F=>a.openModal(i)},t(i.full_name),11,Z)],2),e("td",{class:r(a.getRowClass(i.status))},t(i.phone_number),3),e("td",{class:r(a.getRowClass(i.status))},t(i.status),3),e("td",{class:r(a.getRowClass(i.status))},t(i.amount),3),e("td",{class:r(a.getRowClass(i.status))},t(i.tracking_id),3),e("td",{class:r(a.getRowClass(i.status))},[e("button",{class:"btn btn-sm btn-warning","data-bs-toggle":"modal","data-bs-target":"#visarecordmodal",onClick:F=>a.editRecord(i)},W,8,q)],2)]))),128))])])])]),e("div",H,[e("div",J,[e("div",Q,[e("div",X,[e("h5",Y,t(s.selectedVisa.full_name),1),ee]),e("div",se,[e("table",ie,[e("tbody",null,[e("tr",null,[le,e("td",null,t(s.selectedVisa.phone_number),1)]),e("tr",null,[te,e("td",null,t(s.selectedVisa.status),1)]),e("tr",null,[oe,e("td",null,t(s.selectedVisa.amount),1)]),e("tr",null,[ae,e("td",null,t(s.selectedVisa.visa_fee),1)]),e("tr",null,[re,e("td",null,t(s.selectedVisa.tracking_id),1)]),e("tr",null,[de,e("td",null,t(s.selectedVisa.gmail),1)]),e("tr",null,[ne,e("td",null,t(s.selectedVisa.gender),1)]),e("tr",null,[ue,e("td",null,t(s.selectedVisa.date),1)]),e("tr",null,[ce,e("td",null,t(s.selectedVisa.pak_visa_password),1)]),e("tr",null,[me,e("td",null,t(s.selectedVisa.gmail_password),1)]),e("tr",null,[_e,e("td",null,t(s.selectedVisa.added_by_user),1)])])])])])])]),e("div",he,[e("div",ve,[e("div",pe,[e("div",be,[fe,e("button",ge,null,512)]),e("div",Fe,[e("div",ke,[e("div",null,[e("div",ye,[e("div",we,[Ee,m(e("input",{type:"date",class:r(["form-control",{"is-invalid":s.individualFormErrors.date}]),"onUpdate:modelValue":l[1]||(l[1]=i=>s.individualForm.date=i),max:s.today,id:"date"},null,10,Ve),[[_,s.individualForm.date]]),s.individualFormErrors.date?(d(),n("div",xe,t(s.individualFormErrors.date),1)):u("",!0)]),e("div",Te,[Re,m(e("input",{type:"text",class:r(["form-control",{"is-invalid":s.individualFormErrors.full_name}]),"onUpdate:modelValue":l[2]||(l[2]=i=>s.individualForm.full_name=i)},null,2),[[_,s.individualForm.full_name]]),s.individualFormErrors.full_name?(d(),n("div",Ce,t(s.individualFormErrors.full_name),1)):u("",!0)]),e("div",Ae,[De,m(e("input",{type:"text",class:r(["form-control",{"is-invalid":s.individualFormErrors.phone_number}]),"onUpdate:modelValue":l[3]||(l[3]=i=>s.individualForm.phone_number=i)},null,2),[[_,s.individualForm.phone_number]]),s.individualFormErrors.phone_number?(d(),n("div",Me,t(s.individualFormErrors.phone_number),1)):u("",!0)]),e("div",Pe,[Ie,b(p,{modelValue:s.individualForm.status,"onUpdate:modelValue":l[4]||(l[4]=i=>s.individualForm.status=i),options:s.statusOptions,searchable:!0,class:r({"is-invalid":s.individualFormErrors.status})},null,8,["modelValue","options","class"]),s.individualFormErrors.status?(d(),n("div",Se,t(s.individualFormErrors.status),1)):u("",!0)]),e("div",Ue,[Ne,m(e("input",{type:"text",class:r(["form-control",{"is-invalid":s.individualFormErrors.tracking_id}]),"onUpdate:modelValue":l[5]||(l[5]=i=>s.individualForm.tracking_id=i)},null,2),[[_,s.individualForm.tracking_id]]),s.individualFormErrors.tracking_id?(d(),n("div",Be,t(s.individualFormErrors.tracking_id),1)):u("",!0)]),e("div",ze,[Oe,m(e("input",{type:"number",class:r(["form-control",{"is-invalid":s.individualFormErrors.amount}]),"onUpdate:modelValue":l[6]||(l[6]=i=>s.individualForm.amount=i)},null,2),[[_,s.individualForm.amount]]),s.individualFormErrors.amount?(d(),n("div",Ge,t(s.individualFormErrors.amount),1)):u("",!0)]),e("div",je,[Le,m(e("input",{type:"number",class:r(["form-control",{"is-invalid":s.individualFormErrors.visa_fee}]),"onUpdate:modelValue":l[7]||(l[7]=i=>s.individualForm.visa_fee=i)},null,2),[[_,s.individualForm.visa_fee]]),s.individualFormErrors.visa_fee?(d(),n("div",Ze,t(s.individualFormErrors.visa_fee),1)):u("",!0)]),e("div",qe,[Ke,m(e("input",{type:"email",class:r(["form-control",{"is-invalid":s.individualFormErrors.gmail}]),"onUpdate:modelValue":l[8]||(l[8]=i=>s.individualForm.gmail=i)},null,2),[[_,s.individualForm.gmail]]),s.individualFormErrors.gmail?(d(),n("div",We,t(s.individualFormErrors.gmail),1)):u("",!0)]),e("div",He,[Je,m(e("input",{type:"text",class:r(["form-control",{"is-invalid":s.individualFormErrors.pak_visa_password}]),"onUpdate:modelValue":l[9]||(l[9]=i=>s.individualForm.pak_visa_password=i)},null,2),[[_,s.individualForm.pak_visa_password]]),s.individualFormErrors.pak_visa_password?(d(),n("div",Qe,t(s.individualFormErrors.pak_visa_password),1)):u("",!0)]),e("div",Xe,[Ye,m(e("input",{type:"gmail",class:r(["form-control",{"is-invalid":s.individualFormErrors.gmail_password}]),"onUpdate:modelValue":l[10]||(l[10]=i=>s.individualForm.gmail_password=i)},null,2),[[_,s.individualForm.gmail_password]]),s.individualFormErrors.gmail_password?(d(),n("div",$e,t(s.individualFormErrors.gmail_password),1)):u("",!0)]),e("div",es,[ss,b(p,{modelValue:s.individualForm.gender,"onUpdate:modelValue":l[11]||(l[11]=i=>s.individualForm.gender=i),options:s.genderOptions,searchable:!0,class:r({"invalid-bg":s.individualFormErrors.gender})},null,8,["modelValue","options","class"]),s.individualFormErrors.gender?(d(),n("div",is,t(s.individualFormErrors.gender),1)):u("",!0)]),e("div",ls,[ts,b(p,{modelValue:s.individualForm.referral,"onUpdate:modelValue":l[12]||(l[12]=i=>s.individualForm.referral=i),options:s.pluckedReferrals,searchable:!0,class:r({"invalid-bg":s.individualFormErrors.referral})},null,8,["modelValue","options","class"]),s.individualFormErrors.referral?(d(),n("div",os,t(s.individualFormErrors.referral),1)):u("",!0)])]),e("button",{type:"button",class:"btn btn-success mt-3",onClick:l[13]||(l[13]=(...i)=>a.submitIndividualForm&&a.submitIndividualForm(...i)),disabled:s.individualFormStatus===0},t(s.individualFormStatus===1?"Save":"Saving..."),9,as)])])])])])])])])}const ms=E(R,[["render",rs]]);export{ms as default};
